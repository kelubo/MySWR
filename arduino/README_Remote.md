# SWR驻波表远程Web访问功能说明

本文档详细介绍如何使用SWR驻波表的远程Web访问功能，通过Arduino UNO + Ethernet Shield实现远程监控。

## 硬件需求

1. **Arduino UNO** - 主控制板
2. **Ethernet Shield W5100** - 网络扩展板
3. **LCD 1602** - 显示模块
4. **功率传感器** - 用于测量正向和反向功率（连接到A0和A1引脚）
5. **功能按钮** - 用于切换显示模式（连接到D6引脚）
6. **网线** - 用于连接到局域网

## 硬件连接

### LCD 1602连接
- RS → D12
- EN → D11
- D4 → D5
- D5 → D4
- D6 → D3
- D7 → D2
- VCC → 5V
- GND → GND
- RW → GND（接地表示写入模式）

### 传感器连接
- 正向功率传感器 → A0
- 反向功率传感器 → A1

### 按钮连接
- 功能按钮 → D6（使用内部上拉电阻）

### Ethernet Shield连接
- 直接插在Arduino UNO上
- 插入网线连接到局域网

## 网络配置

### Arduino IP地址设置
默认IP地址为 `192.168.1.177`，可以在 `SWR_Meter_Ethernet.ino` 文件中修改：

```cpp
// 以太网配置
byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED };
IPAddress ip(192, 168, 1, 177);   // Arduino IP地址
EthernetServer server(80);         // Web服务器端口
```

### 确保网络可达
- 将Arduino和访问设备（电脑、手机等）连接到同一个局域网
- 确保路由器的DHCP功能正常工作（如果修改为动态IP）
- 可以使用ping命令测试连接：`ping 192.168.1.177`

## 软件上传

1. 在Arduino IDE中打开 `SWR_Meter_Ethernet.ino` 文件
2. 确保安装了以下库：
   - SPI
   - Ethernet
   - LiquidCrystal
3. 选择正确的开发板（Arduino UNO）和端口
4. 点击上传按钮将代码上传到Arduino

## 远程访问

### 访问方法
1. 确保Arduino已经连接到局域网并正常运行
2. 在浏览器中输入Arduino的IP地址：`http://192.168.1.177`
3. 等待页面加载完成，即可看到实时的SWR驻波表数据

### 页面功能
- **数字表头**：实时显示正向功率、SWR值和反向功率
- **结果显示**：显示详细的SWR值、反射系数和功率损失
- **状态指示器**：根据SWR值显示不同的状态（良好、一般、较差、严重）
- **动态颜色**：SWR区域的边框和数值会根据SWR值自动改变颜色

### 数据更新
页面会自动每秒钟从Arduino获取一次最新数据，无需手动刷新。

## 故障排除

### 无法访问页面
1. 检查Arduino的电源和网络连接
2. 确保Arduino和访问设备在同一个局域网
3. 使用ping命令测试IP地址的可达性
4. 检查Arduino IDE的串口监视器，查看是否有错误信息

### 数据显示异常
1. 检查传感器连接是否正确
2. 确保传感器输出在Arduino的ADC范围内（0-5V）
3. 可以在串口监视器中查看原始的传感器读数

### LCD显示问题
1. 检查LCD的接线是否正确
2. 确保LCD的对比度调节合适
3. 检查代码中的LCD引脚配置是否正确

## 代码说明

### Web服务器功能
- Arduino作为Web服务器，监听80端口
- 提供两个主要端点：
  - `/` - 返回完整的HTML页面
  - `/data` - 返回JSON格式的实时数据

### JSON数据格式
```json
{
  "forwardPower": 100.0,
  "reflectedPower": 0.0,
  "swrValue": 1.0,
  "reflectionCoeff": 0.0,
  "powerLoss": 0.0
}
```

### 客户端JavaScript
- 使用`fetch` API从`/data`端点获取数据
- 每秒钟自动刷新一次
- 根据SWR值动态更新UI和颜色

## 注意事项

1. **网络带宽**：由于Arduino的处理能力有限，建议不要同时有太多设备访问
2. **电源供应**：确保Arduino有足够的电源，特别是在连接多个传感器时
3. **传感器校准**：根据实际使用的传感器类型，可能需要调整代码中的校准参数
4. **防火墙设置**：确保局域网内的防火墙不会阻止对Arduino的访问

## 扩展功能

可以根据需要扩展以下功能：
1. 添加历史数据记录功能
2. 实现报警功能（当SWR值超过阈值时）
3. 添加用户认证机制
4. 实现远程控制功能

## 版本信息

- 版本：1.0
- 日期：2026-01-07
- 作者：Trae AI

